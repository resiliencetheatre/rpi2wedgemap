import{_ as C,D as h,U as m,o as r,c,a as t,t as i,d as Z,b as v,r as b,e as B,w as M,F as x,f as I,g as k}from"./app-BYQp0TIl.js";import{E as p}from"./ElectronUtils-DTJ4pBmU.js";const E={name:"Interface",props:{iface:Object},data(){return{}},methods:{onIFACSignatureClick:function(a){h.alert(a)},isInterfaceEnabled:function(a){return m.isInterfaceEnabled(a)},enableInterface(){this.$emit("enable")},disableInterface(){this.$emit("disable")},editInterface(){this.$emit("edit")},deleteInterface(){this.$emit("delete")},formatBitsPerSecond:function(a){return m.formatBitsPerSecond(a)},formatBytes:function(a){return m.formatBytes(a)}}},H={class:"border rounded bg-white shadow overflow-hidden"},S={key:0,class:"bg-gray-50 p-1 text-sm text-gray-500 space-x-1 border-b"},D={class:"flex text-sm"},P=t("div",{class:"my-auto"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",class:"size-4 text-green-500"},[t("path",{"fill-rule":"evenodd",d:"M10 1a4.5 4.5 0 0 0-4.5 4.5V9H5a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2v-6a2 2 0 0 0-2-2h-.5V5.5A4.5 4.5 0 0 0 10 1Zm3 8V5.5a3 3 0 1 0-6 0V9h6Z","clip-rule":"evenodd"})])],-1),V={class:"ml-1 my-auto"},z={class:"text-green-500"},T={class:"flex py-2"},U={class:"my-auto mx-2"},L={key:0,xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 256 256",class:"size-6"},j=t("path",{d:"M219.31,108.68l-80-80a16,16,0,0,0-22.62,0l-80,80A15.87,15.87,0,0,0,32,120v96a8,8,0,0,0,8,8h64a8,8,0,0,0,8-8V160h32v56a8,8,0,0,0,8,8h64a8,8,0,0,0,8-8V120A15.87,15.87,0,0,0,219.31,108.68ZM208,208H160V152a8,8,0,0,0-8-8H104a8,8,0,0,0-8,8v56H48V120l80-80,80,80Z"},null,-1),R=[j],F={key:1,xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 256 256",class:"size-6"},N=t("path",{d:"M128,88a40,40,0,1,0,40,40A40,40,0,0,0,128,88Zm0,64a24,24,0,1,1,24-24A24,24,0,0,1,128,152Zm73.71,7.14a80,80,0,0,1-14.08,22.2,8,8,0,0,1-11.92-10.67,63.95,63.95,0,0,0,0-85.33,8,8,0,1,1,11.92-10.67,80.08,80.08,0,0,1,14.08,84.47ZM69,103.09a64,64,0,0,0,11.26,67.58,8,8,0,0,1-11.92,10.67,79.93,79.93,0,0,1,0-106.67A8,8,0,1,1,80.29,85.34,63.77,63.77,0,0,0,69,103.09ZM248,128a119.58,119.58,0,0,1-34.29,84,8,8,0,1,1-11.42-11.2,103.9,103.9,0,0,0,0-145.56A8,8,0,1,1,213.71,44,119.58,119.58,0,0,1,248,128ZM53.71,200.78A8,8,0,1,1,42.29,212a119.87,119.87,0,0,1,0-168,8,8,0,1,1,11.42,11.2,103.9,103.9,0,0,0,0,145.56Z"},null,-1),W=[N],q={key:2,xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 256 256",class:"size-6"},O=t("path",{d:"M128,24h0A104,104,0,1,0,232,128,104.12,104.12,0,0,0,128,24Zm88,104a87.61,87.61,0,0,1-3.33,24H174.16a157.44,157.44,0,0,0,0-48h38.51A87.61,87.61,0,0,1,216,128ZM102,168H154a115.11,115.11,0,0,1-26,45A115.27,115.27,0,0,1,102,168Zm-3.9-16a140.84,140.84,0,0,1,0-48h59.88a140.84,140.84,0,0,1,0,48ZM40,128a87.61,87.61,0,0,1,3.33-24H81.84a157.44,157.44,0,0,0,0,48H43.33A87.61,87.61,0,0,1,40,128ZM154,88H102a115.11,115.11,0,0,1,26-45A115.27,115.27,0,0,1,154,88Zm52.33,0H170.71a135.28,135.28,0,0,0-22.3-45.6A88.29,88.29,0,0,1,206.37,88ZM107.59,42.4A135.28,135.28,0,0,0,85.29,88H49.63A88.29,88.29,0,0,1,107.59,42.4ZM49.63,168H85.29a135.28,135.28,0,0,0,22.3,45.6A88.29,88.29,0,0,1,49.63,168Zm98.78,45.6a135.28,135.28,0,0,0,22.3-45.6h35.66A88.29,88.29,0,0,1,148.41,213.6Z"},null,-1),X=[O],G={key:3,xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 256 256",class:"size-6"},J=t("path",{d:"M252.44,121.34l-48-32A8,8,0,0,0,192,96v24H72V72h33a32,32,0,1,0,0-16H72A16,16,0,0,0,56,72v48H8a8,8,0,0,0,0,16H56v48a16,16,0,0,0,16,16h32v8a16,16,0,0,0,16,16h32a16,16,0,0,0,16-16V176a16,16,0,0,0-16-16H120a16,16,0,0,0-16,16v8H72V136H192v24a8,8,0,0,0,12.44,6.66l48-32a8,8,0,0,0,0-13.32ZM136,48a16,16,0,1,1-16,16A16,16,0,0,1,136,48ZM120,176h32v32H120Zm88-30.95V111l25.58,17Z"},null,-1),K=[J],Q={key:4,xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 256 256",class:"size-6"},Y=t("path",{d:"M140,180a12,12,0,1,1-12-12A12,12,0,0,1,140,180ZM128,72c-22.06,0-40,16.15-40,36v4a8,8,0,0,0,16,0v-4c0-11,10.77-20,24-20s24,9,24,20-10.77,20-24,20a8,8,0,0,0-8,8v8a8,8,0,0,0,16,0v-.72c18.24-3.35,32-17.9,32-35.28C168,88.15,150.06,72,128,72Zm104,56A104,104,0,1,1,128,24,104.11,104.11,0,0,1,232,128Zm-16,0a88,88,0,1,0-88,88A88.1,88.1,0,0,0,216,128Z"},null,-1),$=[Y],ee={class:"font-semibold leading-5"},te={class:"text-sm flex space-x-1"},ae={key:0},ne={key:1},se={key:2},ie={key:3},re={key:4},ce={key:5},oe={class:"ml-auto my-auto mr-2"},le={key:0,class:"inline-flex items-center rounded-full bg-green-50 px-2 py-1 text-xs font-medium text-green-700 ring-1 ring-inset ring-green-600/20"},de={key:1,class:"inline-flex items-center rounded-full bg-red-50 px-2 py-1 text-xs font-medium text-red-700 ring-1 ring-inset ring-red-600/20"},fe={class:"my-auto mr-1"},ue=t("span",{class:"flex text-gray-700 bg-gray-100 hover:bg-gray-200 p-2 rounded-full"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"size-5"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M5.636 5.636a9 9 0 1 0 12.728 0M12 3v9"})])],-1),_e=[ue],he=t("span",{class:"flex text-gray-700 bg-gray-100 hover:bg-gray-200 p-2 rounded-full"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"size-5"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M5.636 5.636a9 9 0 1 0 12.728 0M12 3v9"})])],-1),me=[he],ve={class:"my-auto mr-1"},ge=t("span",{class:"flex text-gray-700 bg-gray-100 hover:bg-gray-200 p-2 rounded-full"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"size-5"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"})])],-1),we=[ge],ye={class:"my-auto mr-2"},be=t("span",{class:"flex text-gray-700 bg-gray-100 hover:bg-gray-200 p-2 rounded-full"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-5 h-5"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"})])],-1),xe=[be],Ie={class:"flex bg-gray-50 p-1 text-sm text-gray-500 space-x-1 border-t"},ke={key:0,class:"text-sm text-green-500"},pe={key:1,class:"text-sm text-red-500"},Ce={key:2};function Ae(a,n,e,u,A,s){var _,f,o,l,g,w,y;return r(),c("div",H,[((_=e.iface._stats)==null?void 0:_.ifac_signature)!=null?(r(),c("div",S,[t("div",D,[P,t("span",V,[t("span",z,i(e.iface._stats.ifac_size*8)+"-bit IFAC",1),Z(" with sig "),t("span",{onClick:n[0]||(n[0]=d=>s.onIFACSignatureClick(e.iface._stats.ifac_signature)),class:"cursor-pointer"},"<"+i(e.iface._stats.ifac_signature.slice(0,6))+"..."+i(e.iface._stats.ifac_signature.slice(-6))+">",1)])])])):v("",!0),t("div",T,[t("div",U,[e.iface.type==="AutoInterface"?(r(),c("svg",L,R)):e.iface.type==="RNodeInterface"?(r(),c("svg",F,W)):e.iface.type==="TCPClientInterface"||e.iface.type==="TCPServerInterface"||e.iface.type==="UDPInterface"?(r(),c("svg",q,X)):e.iface.type==="SerialInterface"?(r(),c("svg",G,K)):(r(),c("svg",Q,$))]),t("div",null,[t("div",ee,i(e.iface._name),1),t("div",te,[e.iface.type==="AutoInterface"?(r(),c("span",ae,i(e.iface.type)+" • Ethernet and WiFi ",1)):e.iface.type==="TCPClientInterface"?(r(),c("span",ne,i(e.iface.type)+" • "+i(e.iface.target_host)+":"+i(e.iface.target_port),1)):e.iface.type==="TCPServerInterface"?(r(),c("span",se,i(e.iface.type)+" • "+i(e.iface.listen_ip)+":"+i(e.iface.listen_port),1)):e.iface.type==="UDPInterface"?(r(),c("span",ie,i(e.iface.type)+" • "+i(e.iface.listen_ip)+":"+i(e.iface.listen_port)+" • "+i(e.iface.forward_ip)+":"+i(e.iface.forward_port),1)):e.iface.type==="RNodeInterface"?(r(),c("span",re,i(e.iface.type)+" • "+i(e.iface.port)+" • freq="+i(e.iface.frequency)+" • bw="+i(e.iface.bandwidth)+" • power="+i(e.iface.txpower)+"dBm • sf="+i(e.iface.spreadingfactor)+" • cr="+i(e.iface.codingrate),1)):(r(),c("span",ce,i(e.iface.type??"Unknown Interface Type"),1))])]),t("div",oe,[s.isInterfaceEnabled(e.iface)?(r(),c("span",le,"Enabled")):(r(),c("span",de,"Disabled"))]),t("div",fe,[s.isInterfaceEnabled(e.iface)?(r(),c("button",{key:0,onClick:n[1]||(n[1]=(...d)=>s.disableInterface&&s.disableInterface(...d)),type:"button",class:"cursor-pointer"},_e)):(r(),c("button",{key:1,onClick:n[2]||(n[2]=(...d)=>s.enableInterface&&s.enableInterface(...d)),type:"button",class:"cursor-pointer"},me))]),t("div",ve,[t("button",{onClick:n[3]||(n[3]=(...d)=>s.editInterface&&s.editInterface(...d)),type:"button",class:"cursor-pointer"},we)]),t("div",ye,[t("button",{onClick:n[4]||(n[4]=(...d)=>s.deleteInterface&&s.deleteInterface(...d)),type:"button",class:"cursor-pointer"},xe)])]),t("div",Ie,[((f=e.iface._stats)==null?void 0:f.status)===!0?(r(),c("div",ke,"Connected")):(r(),c("div",pe,"Disconnected")),t("div",null,"• Bitrate: "+i(s.formatBitsPerSecond(((o=e.iface._stats)==null?void 0:o.bitrate)??0)),1),t("div",null,"• TX: "+i(s.formatBytes(((l=e.iface._stats)==null?void 0:l.txb)??0)),1),t("div",null,"• RX: "+i(s.formatBytes(((g=e.iface._stats)==null?void 0:g.rxb)??0)),1),(w=e.iface._stats)!=null&&w.clients?(r(),c("div",Ce,"• Clients: "+i((y=e.iface._stats)==null?void 0:y.clients),1)):v("",!0)])])}const Ze=C(E,[["render",Ae]]),Be={name:"InterfacesPage",components:{Interface:Ze},data(){return{interfaces:{},interfaceStats:{},reloadInterval:null}},beforeUnmount(){clearInterval(this.reloadInterval)},mounted(){this.loadInterfaces(),this.updateInterfaceStats(),this.reloadInterval=setInterval(()=>{this.updateInterfaceStats()},1e3)},methods:{relaunch(){p.relaunch()},isInterfaceEnabled:function(a){return m.isInterfaceEnabled(a)},async loadInterfaces(){try{const a=await window.axios.get("/api/v1/reticulum/interfaces");this.interfaces=a.data.interfaces}catch{}},async updateInterfaceStats(){var a;try{const e=((a=(await window.axios.get("/api/v1/interface-stats")).data.interface_stats)==null?void 0:a.interfaces)??[];for(const u of e)this.interfaceStats[u.name]=u}catch{}},findInterfaceStats(a){const n=this.getInterfaceDescription(a);return this.interfaceStats[n]},getInterfaceDescription(a){const n=this.interfaces[a];if(n)switch(n.type){case"TCPClientInterface":return`TCPInterface[${a}/${n.target_host}:${n.target_port}]`;case"TCPServerInterface":return`TCPServerInterface[${a}/${n.listen_ip}:${n.listen_port}]`;case"UDPInterface":return`UDPInterface[${a}/${n.listen_ip}:${n.listen_port}]`;default:return`${n.type}[${a}]`}return null},async enableInterface(a){try{await window.axios.post("/api/v1/reticulum/interfaces/enable",{name:a})}catch(n){h.alert("failed to enable interface"),console.log(n)}await this.loadInterfaces()},async disableInterface(a){try{await window.axios.post("/api/v1/reticulum/interfaces/disable",{name:a})}catch(n){h.alert("failed to disable interface"),console.log(n)}await this.loadInterfaces()},async editInterface(a){this.$router.push({name:"interfaces.edit",query:{interface_name:a}})},async deleteInterface(a){if(confirm("Are you sure you want to delete this interface? This can not be undone!")){try{await window.axios.post("/api/v1/reticulum/interfaces/delete",{name:a})}catch(n){h.alert("failed to delete interface"),console.log(n)}await this.loadInterfaces()}}},computed:{isElectron(){return p.isElectron()},interfacesWithStats(){const a=[];for(const[n,e]of Object.entries(this.interfaces))e._name=n,e._stats=this.findInterfaceStats(n),a.push(e);return a},enabledInterfaces(){return this.interfacesWithStats.filter(a=>this.isInterfaceEnabled(a))},disabledInterfaces(){return this.interfacesWithStats.filter(a=>!this.isInterfaceEnabled(a))}}},Me={class:"flex flex-col flex-1 overflow-hidden min-w-full sm:min-w-[500px]"},Ee={class:"overflow-y-auto p-2 space-y-2"},He={class:"flex bg-orange-500 p-2 text-sm font-semibold leading-6 text-white rounded shadow"},Se=t("div",{class:"my-auto"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"size-6"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"})])],-1),De=t("div",{class:"ml-2 my-auto"},"Reticulum MeshChat must be restarted for any interface changes to take effect.",-1),Pe=t("span",null,"Restart Now",-1),Ve=[Pe],ze=t("button",{type:"button",class:"my-auto inline-flex items-center gap-x-1 rounded-md bg-gray-500 px-2 py-1 text-sm font-semibold text-white shadow-sm hover:bg-gray-400 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-gray-500"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"size-5"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 4.5v15m7.5-7.5h-15"})]),t("span",null,"Add Interface")],-1),Te={key:0,class:"font-semibold"};function Ue(a,n,e,u,A,s){const _=b("RouterLink"),f=b("Interface");return r(),c("div",Me,[t("div",Ee,[t("div",He,[Se,De,s.isElectron?(r(),c("button",{key:0,onClick:n[0]||(n[0]=(...o)=>s.relaunch&&s.relaunch(...o)),type:"button",class:"ml-auto my-auto inline-flex items-center gap-x-1 rounded-md bg-white px-2 py-1 text-sm font-semibold text-black shadow-sm hover:bg-gray-50 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-white"},Ve)):v("",!0)]),t("div",null,[B(_,{to:{name:"interfaces.add"}},{default:M(()=>[ze]),_:1})]),(r(!0),c(x,null,I(s.enabledInterfaces,o=>(r(),k(f,{iface:o,onEnable:l=>s.enableInterface(o._name),onDisable:l=>s.disableInterface(o._name),onEdit:l=>s.editInterface(o._name),onDelete:l=>s.deleteInterface(o._name)},null,8,["iface","onEnable","onDisable","onEdit","onDelete"]))),256)),s.disabledInterfaces.length>0?(r(),c("div",Te,"Disabled Interfaces")):v("",!0),(r(!0),c(x,null,I(s.disabledInterfaces,o=>(r(),k(f,{iface:o,onEnable:l=>s.enableInterface(o._name),onDisable:l=>s.disableInterface(o._name),onEdit:l=>s.editInterface(o._name),onDelete:l=>s.deleteInterface(o._name)},null,8,["iface","onEnable","onDisable","onEdit","onDelete"]))),256))])])}const Re=C(Be,[["render",Ue]]);export{Re as default};
