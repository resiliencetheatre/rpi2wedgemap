import{W as g,U as f}from"./app-0wRDqa6X.js";import{_ as h,f as m,o as r,t as l,l as e,y as i,C as c,O as d,v as p,k as b,D as y,z as _,A as x,E as v}from"./_plugin-vue_export-helper-N_0dE8fx.js";const k={name:"SettingsPage",data(){return{config:{auto_resend_failed_messages_when_announce_received:null,allow_auto_resending_failed_messages_with_attachments:null,auto_send_failed_messages_to_propagation_node:null,show_suggested_community_interfaces:null,lxmf_local_propagation_node_enabled:null,lxmf_preferred_propagation_node_destination_hash:null}}},beforeUnmount(){g.off("message",this.onWebsocketMessage)},mounted(){g.on("message",this.onWebsocketMessage),this.getConfig()},methods:{async onWebsocketMessage(a){const o=JSON.parse(a.data);switch(o.type){case"config":{this.config=o.config;break}}},async getConfig(){try{const a=await window.axios.get("/api/v1/config");this.config=a.data.config}catch(a){console.log(a)}},async updateConfig(a){try{const o=await window.axios.patch("/api/v1/config",a);this.config=o.data.config}catch(o){alert("Failed to save config!"),console.log(o)}},async onThemeChange(){await this.updateConfig({theme:this.config.theme})},async onAutoResendFailedMessagesWhenAnnounceReceivedChange(){await this.updateConfig({auto_resend_failed_messages_when_announce_received:this.config.auto_resend_failed_messages_when_announce_received})},async onAllowAutoResendingFailedMessagesWithAttachmentsChange(){await this.updateConfig({allow_auto_resending_failed_messages_with_attachments:this.config.allow_auto_resending_failed_messages_with_attachments})},async onAutoSendFailedMessagesToPropagationNodeChange(){await this.updateConfig({auto_send_failed_messages_to_propagation_node:this.config.auto_send_failed_messages_to_propagation_node})},async onShowSuggestedCommunityInterfacesChange(){await this.updateConfig({show_suggested_community_interfaces:this.config.show_suggested_community_interfaces})},async onLxmfPreferredPropagationNodeDestinationHashChange(){await this.updateConfig({lxmf_preferred_propagation_node_destination_hash:this.config.lxmf_preferred_propagation_node_destination_hash})},async onLxmfLocalPropagationNodeEnabledChange(){await this.updateConfig({lxmf_local_propagation_node_enabled:this.config.lxmf_local_propagation_node_enabled})},async onLxmfPreferredPropagationNodeAutoSyncIntervalSecondsChange(){await this.updateConfig({lxmf_preferred_propagation_node_auto_sync_interval_seconds:this.config.lxmf_preferred_propagation_node_auto_sync_interval_seconds})},formatSecondsAgo:function(a){return f.formatSecondsAgo(a)}}},w={class:"flex flex-col flex-1 overflow-hidden min-w-full sm:min-w-[500px] dark:bg-zinc-950"},C={class:"overflow-y-auto space-y-2 p-2"},z={class:"bg-white dark:bg-zinc-800 rounded shadow"},A=e("div",{class:"flex border-b border-gray-300 dark:border-zinc-700 text-gray-700 dark:text-gray-200 p-2 font-semibold"},"Appearance",-1),S={class:"divide-y divide-gray-300 dark:divide-zinc-700 text-gray-900 dark:text-gray-100"},P={class:"p-2"},N={class:"flex"},M=e("option",{value:"light"},"Light Theme",-1),L=e("option",{value:"dark"},"Dark Theme",-1),W=[M,L],I={class:"bg-white dark:bg-zinc-800 rounded shadow"},V=e("div",{class:"flex border-b border-gray-300 dark:border-zinc-700 text-gray-700 dark:text-gray-200 p-2 font-semibold"},"Interfaces",-1),E={class:"divide-y divide-gray-300 dark:divide-zinc-700 text-gray-900 dark:text-gray-100"},U={class:"p-2"},R={class:"flex items-start"},T={class:"flex items-center h-5"},F=e("label",{class:"ml-2 text-sm font-medium text-gray-900 dark:text-gray-100"},"Show Community Interfaces",-1),D=e("div",{class:"text-sm text-gray-700 dark:text-gray-300"},"When enabled, community interfaces will be shown on the Add Interface page.",-1),H={class:"bg-white dark:bg-zinc-800 rounded shadow"},B=e("div",{class:"flex border-b border-gray-300 dark:border-zinc-700 text-gray-700 dark:text-gray-200 p-2 font-semibold"},"Messages",-1),O={class:"divide-y divide-gray-300 dark:divide-zinc-700 text-gray-900 dark:text-gray-100"},j={class:"p-2"},J={class:"flex items-start"},q={class:"flex items-center h-5"},G=e("label",{class:"ml-2 text-sm font-medium text-gray-900 dark:text-gray-100"},"Auto resend",-1),K=e("div",{class:"text-sm text-gray-700 dark:text-gray-300"},"When enabled, failed messages will auto resend when an announce is received from the intended destination.",-1),Q={class:"p-2"},X={class:"flex items-start"},Y={class:"flex items-center h-5"},Z=e("label",{class:"ml-2 text-sm font-medium text-gray-900 dark:text-gray-100"},"Allow resending with attachments",-1),$=e("div",{class:"text-sm text-gray-700 dark:text-gray-300"},"When enabled, failed messages that have attachments are allowed to auto resend.",-1),ee={class:"p-2"},oe={class:"flex items-start"},te={class:"flex items-center h-5"},se=e("label",{class:"ml-2 text-sm font-medium text-gray-900 dark:text-gray-100"},"Auto send to propagation node",-1),ne=e("div",{class:"text-sm text-gray-700 dark:text-gray-300"},"When enabled, messages that fail to send will be sent to the configured propagation node.",-1),ae={class:"bg-white dark:bg-zinc-800 rounded shadow"},ie={class:"flex border-b border-gray-300 dark:border-zinc-700 text-gray-700 dark:text-gray-200 p-2 font-semibold"},de=e("div",{class:"my-auto mr-auto"},"Propagation Nodes",-1),re={class:"my-auto"},le={class:"divide-y divide-gray-300 dark:divide-zinc-700 text-gray-900 dark:text-gray-100"},ge=e("div",{class:"p-2"},[e("div",{class:"text-sm text-gray-700 dark:text-gray-300"},[e("ul",{class:"list-disc list-inside"},[e("li",null,"When you send a message, the intended recipient may be offline and your message will fail to send."),e("li",null,"Instead, messages can be sent to propagation nodes, which store the messages and allow recipients to retrieve them when they're next online."),e("li",null,"Propagation nodes automatically peer and sync messages with each other, creating an encrypted, distributed message store."),e("li",null,"By default, propagation nodes store messages for up to 30 days. If the recipient hasn't retrieved it by then, the message will be lost."),e("li",null,"At this time, delivery reports are unavailable for messages sent to propagation nodes.")])])],-1),ce={class:"p-2"},_e={class:"flex items-start"},ue={class:"flex items-center h-5"},fe=e("label",{class:"ml-2 text-sm font-medium text-gray-900 dark:text-gray-100"},"Local Propagation Node",-1),he=e("div",{class:"text-sm text-gray-700 dark:text-gray-300"},"When enabled, MeshChat will run a Propagation Node and announce it with the following address for other clients to use.",-1),me={class:"flex"},pe={class:"p-2"},be=e("div",{class:"text-sm font-medium text-gray-900 dark:text-gray-100"},"Preferred Propagation Node",-1),ye={class:"flex"},xe=e("div",{class:"text-sm text-gray-700 dark:text-gray-300"},"This is the propagation node your messages will be sent to and retrieved from.",-1),ve={class:"p-2"},ke=e("div",{class:"text-sm font-medium text-gray-900 dark:text-gray-100"},"Auto Sync Interval",-1),we={class:"flex"},Ce=v('<option value="0">Disabled</option><option value="900">Every 15 Minutes</option><option value="1800">Every 30 Minutes</option><option value="3600">Every 1 Hour</option><option value="10800">Every 3 Hours</option><option value="21600">Every 6 Hours</option><option value="43200">Every 12 Hours</option><option value="86400">Every 24 Hours</option>',8),ze=[Ce],Ae={class:"text-sm text-gray-700 dark:text-gray-300"},Se={key:0},Pe={key:1};function Ne(a,o,Me,Le,s,n){const u=m("RouterLink");return r(),l("div",w,[e("div",C,[e("div",z,[A,e("div",S,[e("div",P,[e("div",N,[i(e("select",{"onUpdate:modelValue":o[0]||(o[0]=t=>s.config.theme=t),onChange:o[1]||(o[1]=(...t)=>n.onThemeChange&&n.onThemeChange(...t)),class:"bg-gray-50 dark:bg-zinc-700 border border-gray-300 dark:border-zinc-600 text-gray-900 dark:text-gray-100 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 dark:focus:ring-blue-600 dark:focus:border-blue-600 block w-full p-2.5"},W,544),[[c,s.config.theme]])])])])]),e("div",I,[V,e("div",E,[e("div",U,[e("div",R,[e("div",T,[i(e("input",{"onUpdate:modelValue":o[2]||(o[2]=t=>s.config.show_suggested_community_interfaces=t),onChange:o[3]||(o[3]=(...t)=>n.onShowSuggestedCommunityInterfacesChange&&n.onShowSuggestedCommunityInterfacesChange(...t)),type:"checkbox",class:"w-4 h-4 border border-gray-300 dark:border-zinc-600 rounded bg-gray-50 dark:bg-zinc-700 focus:ring-3 focus:ring-blue-300 dark:focus:ring-blue-600"},null,544),[[d,s.config.show_suggested_community_interfaces]])]),F]),D])])]),e("div",H,[B,e("div",O,[e("div",j,[e("div",J,[e("div",q,[i(e("input",{"onUpdate:modelValue":o[4]||(o[4]=t=>s.config.auto_resend_failed_messages_when_announce_received=t),onChange:o[5]||(o[5]=(...t)=>n.onAutoResendFailedMessagesWhenAnnounceReceivedChange&&n.onAutoResendFailedMessagesWhenAnnounceReceivedChange(...t)),type:"checkbox",class:"w-4 h-4 border border-gray-300 dark:border-zinc-600 rounded bg-gray-50 dark:bg-zinc-700 focus:ring-3 focus:ring-blue-300 dark:focus:ring-blue-600"},null,544),[[d,s.config.auto_resend_failed_messages_when_announce_received]])]),G]),K]),e("div",Q,[e("div",X,[e("div",Y,[i(e("input",{"onUpdate:modelValue":o[6]||(o[6]=t=>s.config.allow_auto_resending_failed_messages_with_attachments=t),onChange:o[7]||(o[7]=(...t)=>n.onAllowAutoResendingFailedMessagesWithAttachmentsChange&&n.onAllowAutoResendingFailedMessagesWithAttachmentsChange(...t)),type:"checkbox",class:"w-4 h-4 border border-gray-300 dark:border-zinc-600 rounded bg-gray-50 dark:bg-zinc-700 focus:ring-3 focus:ring-blue-300 dark:focus:ring-blue-600"},null,544),[[d,s.config.allow_auto_resending_failed_messages_with_attachments]])]),Z]),$]),e("div",ee,[e("div",oe,[e("div",te,[i(e("input",{"onUpdate:modelValue":o[8]||(o[8]=t=>s.config.auto_send_failed_messages_to_propagation_node=t),onChange:o[9]||(o[9]=(...t)=>n.onAutoSendFailedMessagesToPropagationNodeChange&&n.onAutoSendFailedMessagesToPropagationNodeChange(...t)),type:"checkbox",class:"w-4 h-4 border border-gray-300 dark:border-zinc-600 rounded bg-gray-50 dark:bg-zinc-700 focus:ring-3 focus:ring-blue-300 dark:focus:ring-blue-600"},null,544),[[d,s.config.auto_send_failed_messages_to_propagation_node]])]),se]),ne])])]),e("div",ae,[e("div",ie,[de,e("div",re,[p(u,{to:{name:"propagation-nodes"},class:"my-auto inline-flex items-center gap-x-1 rounded-md bg-gray-500 dark:bg-zinc-600 px-2 py-1 text-sm font-semibold text-white shadow-sm hover:bg-gray-400 dark:hover:bg-zinc-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-gray-500 dark:focus-visible:outline-zinc-500"},{default:b(()=>[y(" Browse Nodes ")]),_:1})])]),e("div",le,[ge,e("div",ce,[e("div",_e,[e("div",ue,[i(e("input",{"onUpdate:modelValue":o[10]||(o[10]=t=>s.config.lxmf_local_propagation_node_enabled=t),onChange:o[11]||(o[11]=(...t)=>n.onLxmfLocalPropagationNodeEnabledChange&&n.onLxmfLocalPropagationNodeEnabledChange(...t)),type:"checkbox",class:"w-4 h-4 border border-gray-300 dark:border-zinc-600 rounded bg-gray-50 dark:bg-zinc-700 focus:ring-3 focus:ring-blue-300 dark:focus:ring-blue-600"},null,544),[[d,s.config.lxmf_local_propagation_node_enabled]])]),fe]),he,e("div",me,[i(e("input",{disabled:"","onUpdate:modelValue":o[12]||(o[12]=t=>s.config.lxmf_local_propagation_node_address_hash=t),type:"text",class:"bg-gray-200 dark:bg-zinc-800 border border-gray-300 dark:border-zinc-600 text-gray-900 dark:text-gray-100 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 dark:focus:ring-blue-600 dark:focus:border-blue-600 block w-full p-2.5"},null,512),[[_,s.config.lxmf_local_propagation_node_address_hash]])])]),e("div",pe,[be,e("div",ye,[i(e("input",{"onUpdate:modelValue":o[13]||(o[13]=t=>s.config.lxmf_preferred_propagation_node_destination_hash=t),onInput:o[14]||(o[14]=(...t)=>n.onLxmfPreferredPropagationNodeDestinationHashChange&&n.onLxmfPreferredPropagationNodeDestinationHashChange(...t)),type:"text",placeholder:"Destination Hash. e.g: a39610c89d18bb48c73e429582423c24",class:"bg-gray-50 dark:bg-zinc-700 border border-gray-300 dark:border-zinc-600 text-gray-900 dark:text-gray-100 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 dark:focus:ring-blue-600 dark:focus:border-blue-600 block w-full p-2.5"},null,544),[[_,s.config.lxmf_preferred_propagation_node_destination_hash]])]),xe]),e("div",ve,[ke,e("div",we,[i(e("select",{"onUpdate:modelValue":o[15]||(o[15]=t=>s.config.lxmf_preferred_propagation_node_auto_sync_interval_seconds=t),onChange:o[16]||(o[16]=(...t)=>n.onLxmfPreferredPropagationNodeAutoSyncIntervalSecondsChange&&n.onLxmfPreferredPropagationNodeAutoSyncIntervalSecondsChange(...t)),class:"bg-gray-50 dark:bg-zinc-700 border border-gray-300 dark:border-zinc-600 text-gray-900 dark:text-gray-100 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 dark:focus:ring-blue-600 dark:focus:border-blue-600 block w-full p-2.5"},ze,544),[[c,s.config.lxmf_preferred_propagation_node_auto_sync_interval_seconds]])]),e("div",Ae,[s.config.lxmf_preferred_propagation_node_last_synced_at?(r(),l("span",Se,"Last Synced: "+x(n.formatSecondsAgo(s.config.lxmf_preferred_propagation_node_last_synced_at)),1)):(r(),l("span",Pe,"Last Synced: Never"))])])])])])])}const Ve=h(k,[["render",Ne]]);export{Ve as default};
