import{M as B,U as H,W as N,D as C,G as O}from"./app-DgFzPxLe.js";import{_ as T,e as D,o as h,q as g,k as d,y as L,z as F,B as P,H as A,S as j,m as U,t as z,A as y,E as M,W as q,x as R}from"./_plugin-vue_export-helper-oA2e8qpL.js";class S{constructor(e=!0){this.darkTheme=e,this.DEFAULT_FG_DARK="ddd",this.DEFAULT_FG_LIGHT="222",this.DEFAULT_BG="default",this.SELECTED_STYLES=null,this.STYLES_DARK={plain:{fg:this.DEFAULT_FG_DARK,bg:this.DEFAULT_BG,bold:!1,underline:!1,italic:!1},heading1:{fg:"222",bg:"bbb",bold:!1,underline:!1,italic:!1},heading2:{fg:"111",bg:"999",bold:!1,underline:!1,italic:!1},heading3:{fg:"000",bg:"777",bold:!1,underline:!1,italic:!1}},this.STYLES_LIGHT={plain:{fg:this.DEFAULT_FG_LIGHT,bg:this.DEFAULT_BG,bold:!1,underline:!1,italic:!1},heading1:{fg:"000",bg:"777",bold:!1,underline:!1,italic:!1},heading2:{fg:"111",bg:"aaa",bold:!1,underline:!1,italic:!1},heading3:{fg:"222",bg:"ccc",bold:!1,underline:!1,italic:!1}},this.darkTheme?this.SELECTED_STYLES=this.STYLES_DARK:this.SELECTED_STYLES=this.STYLES_LIGHT}static formatNomadnetworkUrl(e){return`nomadnetwork://${e}`}convertMicronToHtml(e){let t="",s={literal:!1,depth:0,fg_color:this.SELECTED_STYLES.plain.fg,bg_color:this.DEFAULT_BG,formatting:{bold:!1,underline:!1,italic:!1,strikethrough:!1},default_align:"left",align:"left",radio_groups:{}};const o=e.split(`
`);for(let r of o){const i=this.parseLine(r,s);if(i&&i.length>0)for(let n of i)t+=n.outerHTML;else t+="<br>"}return t}parseToHtml(e){const t=document.createDocumentFragment();let s={literal:!1,depth:0,fg_color:this.SELECTED_STYLES.plain.fg,bg_color:this.DEFAULT_BG,formatting:{bold:!1,underline:!1,italic:!1,strikethrough:!1},default_align:"left",align:"left",radio_groups:{}};const o=e.split(`
`);for(let r of o){const i=this.parseLine(r,s);if(i&&i.length>0)for(let n of i)t.appendChild(n);else t.appendChild(document.createElement("br"))}return t}parseLine(e,t){if(e.length>0){if(e==="`=")return t.literal=!t.literal,null;if(!t.literal){if(e[0]==="#")return null;if(e[0]==="<")return t.depth=0,this.parseLine(e.slice(1),t);if(e[0]===">"){let o=0;for(;o<e.length&&e[o]===">";)o++;t.depth=o;let r=e.slice(o);if(r.length>0){let i=null,n="heading"+o;this.SELECTED_STYLES[n]?i=this.SELECTED_STYLES[n]:i=this.SELECTED_STYLES.plain;const l=this.stateToStyle(t);this.styleToState(i,t);let c=this.makeOutput(t,r);if(this.styleToState(l,t),c&&c.length>0){const u=document.createElement("div");return this.applyAlignment(u,t),this.applySectionIndent(u,t),this.appendOutput(u,c,t),[u]}else return null}else return null}if(e[0]==="-"){e.length>1&&e[1];const o=document.createElement("hr");return this.applySectionIndent(o,t),[o]}}let s=this.makeOutput(t,e);if(s){let o=document.createElement("div");return this.applyAlignment(o,t),this.applySectionIndent(o,t),this.appendOutput(o,s,t),[o]}else return[document.createElement("br")]}else return[document.createElement("br")]}applyAlignment(e,t){e.style.textAlign=t.align||"left"}applySectionIndent(e,t){let s=(t.depth-1)*2;s>0&&(e.style.marginLeft=s*10+"px")}stateToStyle(e){return{fg:e.fg_color,bg:e.bg_color,bold:e.formatting.bold,underline:e.formatting.underline,italic:e.formatting.italic}}styleToState(e,t){e.fg!==void 0&&e.fg!==null&&(t.fg_color=e.fg),e.bg!==void 0&&e.bg!==null&&(t.bg_color=e.bg),e.bold!==void 0&&e.bold!==null&&(t.formatting.bold=e.bold),e.underline!==void 0&&e.underline!==null&&(t.formatting.underline=e.underline),e.italic!==void 0&&e.italic!==null&&(t.formatting.italic=e.italic)}appendOutput(e,t,s){let o=null,r=null;const i=()=>{o&&(e.appendChild(o),o=null,r=null)};for(let n of t)if(typeof n=="string"){let l=document.createElement("span");l.textContent=n,e.appendChild(l)}else if(Array.isArray(n)&&n.length===2){let[l,c]=n;this.stylesEqual(l,r)||(i(),o=document.createElement("span"),this.applyStyleToElement(o,l),r=l),o.textContent+=c}else if(n&&typeof n=="object"){if(i(),n.type==="field"){let l=document.createElement("input");l.type=n.masked?"password":"text",l.name=n.name,l.setAttribute("value",n.data),n.width&&(l.size=n.width),this.applyStyleToElement(l,this.styleFromState(n.style)),e.appendChild(l)}else if(n.type==="checkbox"){let l=document.createElement("label"),c=document.createElement("input");c.type="checkbox",c.name=n.name,c.value=n.value,n.prechecked&&c.setAttribute("checked",!0),l.appendChild(c),l.appendChild(document.createTextNode(" "+n.label)),this.applyStyleToElement(l,this.styleFromState(n.style)),e.appendChild(l)}else if(n.type==="radio"){let l=document.createElement("label"),c=document.createElement("input");c.type="radio",c.name=n.name,c.value=n.value,n.prechecked&&c.setAttribute("checked",!0),l.appendChild(c),l.appendChild(document.createTextNode(" "+n.label)),this.applyStyleToElement(l,this.styleFromState(n.style)),e.appendChild(l)}else if(n.type==="link"){let l=n.url.replace("nomadnetwork://","").replace("lxmf://","");const c=n.url;let u=document.createElement("a");u.href=c,u.title=c;let f=[],p={},w=!1;if(n.fields&&n.fields.length>0){for(const m of n.fields)if(m==="*")w=!0;else if(m.includes("=")){const[x,k]=m.split("=");p[x]=k}else f.push(m);let _="";w?_="*":_=f.join("|");const v=Object.entries(p);if(v.length>0){const m=v.map(([x,k])=>`${x}=${k}`).join("|");l+=l.includes("`")?`|${m}`:`\`${m}`}u.setAttribute("onclick",`event.preventDefault(); onNodePageUrlClick('${l}', '${_}', false, false)`)}else u.setAttribute("onclick",`event.preventDefault(); onNodePageUrlClick('${l}', null, false, false)`);u.textContent=n.label,this.applyStyleToElement(u,this.styleFromState(n.style)),e.appendChild(u)}}i()}stylesEqual(e,t){return!e&&!t?!0:!e||!t?!1:e.fg===t.fg&&e.bg===t.bg&&e.bold===t.bold&&e.underline===t.underline&&e.italic===t.italic}styleFromState(e){return e}applyStyleToElement(e,t){if(!t)return;let s=this.colorToCss(t.fg),o=this.colorToCss(t.bg);s&&s!=="default"&&(e.style.color=s),o&&o!=="default"&&(e.style.backgroundColor=o),t.bold&&(e.style.fontWeight="bold"),t.underline&&(e.style.textDecoration=e.style.textDecoration?e.style.textDecoration+" underline":"underline"),t.italic&&(e.style.fontStyle="italic")}colorToCss(e){if(!e||e==="default")return null;if(e.length===3&&/^[0-9a-fA-F]{3}$/.test(e)||e.length===6&&/^[0-9a-fA-F]{6}$/.test(e))return"#"+e;if(e.length===3&&e[0]==="g"){let t=parseInt(e.slice(1),10);isNaN(t)&&(t=50);let s=Math.floor(t*2.55).toString(16).padStart(2,"0");return"#"+s+s+s}return null}makeOutput(e,t){if(e.literal)return t==="\\`="&&(t="`="),[[this.stateToStyle(e),t]];let s=[],o="",r="text",i=!1,n=0,l=0;for(;l<t.length;){let c=t[l];if(n>0){n--,l++;continue}if(r==="formatting"){switch(c){case"_":e.formatting.underline=!e.formatting.underline;break;case"!":e.formatting.bold=!e.formatting.bold;break;case"*":e.formatting.italic=!e.formatting.italic;break;case"F":if(t.length>=l+4){let p=t.substr(l+1,3);e.fg_color=p,n=3}break;case"f":e.fg_color=this.SELECTED_STYLES.plain.fg;break;case"B":if(t.length>=l+4){let p=t.substr(l+1,3);e.bg_color=p,n=3}break;case"b":e.bg_color=this.DEFAULT_BG;break;case"`":e.formatting.bold=!1,e.formatting.underline=!1,e.formatting.italic=!1,e.fg_color=this.SELECTED_STYLES.plain.fg,e.bg_color=this.DEFAULT_BG,e.align=e.default_align;break;case"c":e.align=e.align==="center"?e.default_align:"center";break;case"l":e.align=e.align==="left"?e.default_align:"left";break;case"r":e.align=e.align==="right"?e.default_align:"right";break;case"a":e.align=e.default_align;break;case"<":o.length>0&&(s.push([this.stateToStyle(e),o]),o="");let u=this.parseField(t,l,e);if(u){s.push(u.obj),l+=u.skip;continue}break;case"[":o.length>0&&(s.push([this.stateToStyle(e),o]),o="");let f=this.parseLink(t,l,e);if(f){s.push(f.obj),l+=f.skip;continue}break}r="text",o.length>0}else c==="\\"?i?(o+=c,i=!1):i=!0:c==="`"?i?(o+=c,i=!1):(o.length>0&&(s.push([this.stateToStyle(e),o]),o=""),r="formatting"):(i&&(o+="\\",i=!1),o+=c);l++}return o.length>0&&s.push([this.stateToStyle(e),o]),s.length>0?s:null}parseField(e,t,s){let o=t+1,r=e.indexOf("`",o);if(r===-1)return null;let i=e.substring(o,r),n=!1,l=24,c="field",u=i,f="",p=!1;if(i.includes("|")){let k=i.split("|"),b=k[0];if(u=k[1],b.includes("^")?(c="radio",b=b.replace("^","")):b.includes("?")?(c="checkbox",b=b.replace("?","")):b.includes("!")&&(n=!0,b=b.replace("!","")),b.length>0){let E=parseInt(b,10);isNaN(E)||(l=Math.min(E,256))}k.length>2&&(f=k[2]),k.length>3&&k[3]==="*"&&(p=!0)}let w=e.indexOf(">",r);if(w===-1)return null;let _=e.substring(r+1,w),v=this.stateToStyle(s),m=null;c==="checkbox"||c==="radio"?m={type:c,name:u,value:f||_,label:_,prechecked:p,style:v}:m={type:"field",name:u,width:l,masked:n,data:_,style:v};let x=w-t+2;return{obj:m,skip:x}}parseLink(e,t,s){let o=e.indexOf("]",t);if(o===-1)return null;let r=e.substring(t+1,o),i=r.split("`"),n="",l="",c="";if(i.length===1?(n="",l=r):i.length===2?(n=i[0],l=i[1]):i.length===3&&(n=i[0],l=i[1],c=i[2]),l.length===0)return null;n===""&&(n=l),l=S.formatNomadnetworkUrl(l);let u=this.stateToStyle(s),f={type:"link",url:l,label:n,fields:c?c.split("|"):[],style:u},p=o-t+2;return{obj:f,skip:p}}}const $={name:"NomadNetworkSidebar",components:{MaterialDesignIcon:B},props:{nodes:Object,selectedDestinationHash:String},data(){return{nodesSearchTerm:""}},methods:{onNodeClick(a){this.$emit("node-click",a)},formatTimeAgo:function(a){return H.formatTimeAgo(a)}},computed:{nodesCount(){return Object.keys(this.nodes).length},nodesOrderedByLatestAnnounce(){return Object.values(this.nodes).sort(function(e,t){const s=new Date(e.updated_at).getTime();return new Date(t.updated_at).getTime()-s})},searchedNodes(){return this.nodesOrderedByLatestAnnounce.filter(a=>{const e=this.nodesSearchTerm.toLowerCase(),t=a.display_name.toLowerCase().includes(e),s=a.destination_hash.toLowerCase().includes(e);return t||s})}}},G={class:"flex flex-col w-80 min-w-80"},I={class:"flex-1 flex flex-col bg-white dark:bg-zinc-950 border-r dark:border-zinc-800 overflow-hidden"},K={key:0,class:"p-1 border-b border-gray-300 dark:border-zinc-800"},W=["placeholder"],Y={class:"flex h-full overflow-y-auto"},V={key:0,class:"w-full"},Z=["onClick"],J={class:"my-auto mr-2"},Q={class:"bg-gray-200 dark:bg-zinc-800 text-gray-500 dark:text-gray-400 p-2 rounded"},X={class:"text-gray-900 dark:text-gray-100"},ee={class:"text-gray-500 dark:text-gray-400 text-sm"},te={key:1,class:"mx-auto my-auto text-center leading-5"},oe={key:0,class:"flex flex-col"},le=M('<div class="mx-auto mb-1"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 text-gray-500 dark:text-gray-400"><path stroke-linecap="round" stroke-linejoin="round" d="M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 5.25h.008v.008H12v-.008Z"></path></svg></div><div class="font-semibold text-gray-900 dark:text-gray-100">No Nodes Discovered</div><div class="text-gray-500 dark:text-gray-400">Waiting for a node to announce!</div>',3),ne=[le],ae={key:1,class:"flex flex-col"},se=M('<div class="mx-auto mb-1"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 text-gray-500 dark:text-gray-400"><path stroke-linecap="round" stroke-linejoin="round" d="m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"></path></svg></div><div class="font-semibold text-gray-900 dark:text-gray-100">No Search Results</div><div class="text-gray-500 dark:text-gray-400">Your search didn&#39;t match any Nodes!</div>',3),ie=[se];function re(a,e,t,s,o,r){const i=D("MaterialDesignIcon");return h(),g("div",G,[d("div",I,[r.nodesCount>0?(h(),g("div",K,[L(d("input",{"onUpdate:modelValue":e[0]||(e[0]=n=>o.nodesSearchTerm=n),type:"text",placeholder:`Search ${r.nodesCount} Nodes...`,class:"bg-gray-50 dark:bg-zinc-900 border border-gray-300 dark:border-zinc-700 text-gray-900 dark:text-gray-100 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:placeholder-gray-400"},null,8,W),[[F,o.nodesSearchTerm]])])):P("",!0),d("div",Y,[r.searchedNodes.length>0?(h(),g("div",V,[(h(!0),g(A,null,j(r.searchedNodes,n=>(h(),g("div",{onClick:l=>r.onNodeClick(n),class:U(["flex cursor-pointer p-2 border-l-2",[n.destination_hash===t.selectedDestinationHash?"bg-gray-100 dark:bg-zinc-800 border-blue-500":"bg-white dark:bg-zinc-950 border-transparent hover:bg-gray-50 dark:hover:bg-zinc-900 hover:border-gray-200 dark:hover:border-zinc-700"]])},[d("div",J,[d("div",Q,[z(i,{"icon-name":"server-network-outline",class:"w-6 h-6"})])]),d("div",null,[d("div",X,y(n.display_name),1),d("div",ee,y(r.formatTimeAgo(n.updated_at)),1)])],10,Z))),256))])):(h(),g("div",te,[r.nodesCount===0?(h(),g("div",oe,ne)):P("",!0),o.nodesSearchTerm!==""&&r.nodesCount>0?(h(),g("div",ae,ie)):P("",!0)]))])])])}const de=T($,[["render",re]]),ce={name:"NomadNetworkPage",components:{NomadNetworkSidebar:de},data(){return{nodes:{},selectedNode:null,selectedNodePath:null,isLoadingNodePage:!1,nodePageRequestSequence:0,nodePagePath:null,nodePagePathUrlInput:null,nodePageContent:null,nodePageProgress:0,nodePagePathHistory:[],nodePageCache:{},isDownloadingNodeFile:!1,nodeFilePath:null,nodeFileProgress:0,nomadnetPageDownloadCallbacks:{},nomadnetFileDownloadCallbacks:{}}},beforeUnmount(){N.off("message",this.onWebsocketMessage)},mounted(){N.on("message",this.onWebsocketMessage),window.onNodePageUrlClick=(a,e=null)=>{this.onNodePageUrlClick(a,e)},this.getNomadnetworkNodeAnnounces()},methods:{async onWebsocketMessage(a){const e=JSON.parse(a.data);switch(e.type){case"announce":{e.announce.aspect==="nomadnetwork.node"&&this.updateNodeFromAnnounce(e.announce);break}case"nomadnet.page.download":{const t=e.nomadnet_page_download,s=this.getNomadnetPageDownloadCallbackKey(t.destination_hash,t.page_path),o=this.nomadnetPageDownloadCallbacks[s];if(!o){console.log("did not find nomadnet page download callback for key: "+s);return}if(t.status==="success"&&o.onSuccessCallback){o.onSuccessCallback(t.page_content),delete this.nomadnetPageDownloadCallbacks[s];return}if(t.status==="failure"&&o.onFailureCallback){o.onFailureCallback(t.failure_reason),delete this.nomadnetPageDownloadCallbacks[s];return}if(t.status==="progress"&&o.onProgressCallback){o.onProgressCallback(t.progress);return}break}case"nomadnet.file.download":{const t=e.nomadnet_file_download,s=this.getNomadnetFileDownloadCallbackKey(t.destination_hash,t.file_path),o=this.nomadnetFileDownloadCallbacks[s];if(!o){console.log("did not find nomadnet file download callback for key: "+s);return}if(t.status==="success"&&o.onSuccessCallback){o.onSuccessCallback(t.file_name,t.file_bytes),delete this.nomadnetFileDownloadCallbacks[s];return}if(t.status==="failure"&&o.onFailureCallback){o.onFailureCallback(t.failure_reason),delete this.nomadnetFileDownloadCallbacks[s];return}if(t.status==="progress"&&o.onProgressCallback){o.onProgressCallback(t.progress);return}break}}},onDestinationPathClick:function(a){C.alert(`${a.hops} ${a.hops===1?"hop":"hops"} away via ${a.next_hop_interface}`)},async getNomadnetworkNodeAnnounces(){try{const e=(await window.axios.get("/api/v1/announces",{params:{aspect:"nomadnetwork.node"}})).data.announces;for(const t of e)this.updateNodeFromAnnounce(t)}catch(a){console.log(a)}},updateNodeFromAnnounce:function(a){this.nodes[a.destination_hash]=a},async openUrl(){const a=await C.prompt("Enter a Nomadnet URL");a&&await this.onNodePageUrlClick(a)},async loadNodePage(a,e,t=null,s=!0,o=!0){const r=++this.nodePageRequestSequence,i=this.nodePagePath;if(this.isLoadingNodePage=!0,this.nodePagePath=`${a}:${e}`,this.nodePageContent=null,this.nodePageProgress=0,this.nodePagePathUrlInput=this.nodePagePath,this.getNodePath(a),s&&i!=null&&i!==this.nodePagePath&&this.nodePagePathHistory.push(i),o){const n=`${a}:${e}`,l=this.nodePageCache[n];if(l!=null){this.nodePageContent=l,this.isLoadingNodePage=!1;return}}this.downloadNomadNetPage(a,e,t,n=>{const l=new S;if(r!==this.nodePageRequestSequence){console.log("ignoring page content callback for previous page request");return}const[c,u]=e.split("`");c.endsWith(".mu")?this.nodePageContent=l.convertMicronToHtml(n):this.nodePageContent=n;const f=`${a}:${e}`;this.nodePageCache[f]=this.nodePageContent,this.isLoadingNodePage=!1,this.getNodePath(a)},n=>{if(r!==this.nodePageRequestSequence){console.log("ignoring failure callback for previous page request");return}this.nodePageContent=`Failed loading page: ${n}`,this.isLoadingNodePage=!1,this.getNodePath(a)},n=>{if(r!==this.nodePageRequestSequence){console.log("ignoring progress callback for previous page request");return}this.nodePageProgress=Math.round(n*100)})},async reloadNodePage(){this.onNodePageUrlClick(this.nodePagePath,null,!1,!1)},async loadPreviousNodePage(){const a=this.nodePagePathHistory.pop();a&&this.onNodePageUrlClick(a,null,null,!0)},parseNomadnetworkUrl:function(a){if(a.startsWith(":")){var e=a.substring(1);return e===""&&(e="/page/index.mu"),{destination_hash:null,path:e}}if(a.includes(":")){const[t,...s]=a.split(":");if(t.length===32)return{destination_hash:t,path:s.join(":")}}return a.length===32?{destination_hash:a,path:"/page/index.mu"}:null},async onNodePageUrlClick(a,e=null,t=!0,s=!1){let o=[];if(e==="*"){s=!1;const i=document.querySelectorAll(".nodeContainer input"),n={};for(const l of i)l.type==="radio"||l.type==="checkbox"?l.checked&&(n[l.name]=l.value):n[l.name||l.id||l.type]=l.value;o=n}else if(e!==null&&e!==""){s=!1;const i=e.split("|"),n=document.querySelectorAll(".nodeContainer input"),l={};for(const c of n)i.includes(c.name)&&(c.type==="radio"||c.type==="checkbox"?c.checked&&(l[c.name]=c.value):l[c.name]=c.value);o=l}if(console.log(o),a.startsWith("http://")||a.startsWith("https://")){window.open(a,"_blank");return}if(a.startsWith("lxmf@")){const i=a.replace("lxmf@","");if(i.length===32){await this.$router.push({name:"messages"}),O.emit("compose-new-message",i);return}}const r=this.parseNomadnetworkUrl(a);if(r!=null){const i=r.destination_hash||this.selectedNode.destination_hash;if(r.path.startsWith("/file/")){if(this.isDownloadingNodeFile){C.alert("An existing download is in progress. Please wait for it to finish before starting another download.");return}this.isDownloadingNodeFile=!0,this.nodeFilePath=r.path.split("/").pop(),this.nodeFileProgress=0,this.downloadNomadNetFile(i,r.path,(n,l)=>{this.isDownloadingNodeFile=!1,this.downloadFileFromBase64(n,l)},n=>{this.isDownloadingNodeFile=!1,C.alert(`Failed to download file: ${n}`)},n=>{this.nodeFileProgress=Math.round(n*100)});return}this.selectedNode=this.nodes[i]||{display_name:"Unknown Node",destination_hash:i},this.loadNodePage(i,r.path,o,t,s);return}C.alert("unsupported url: "+a)},downloadFileFromBase64:async function(a,e){const t=atob(e),s=new Array(t.length);for(let l=0;l<t.length;l++)s[l]=t.charCodeAt(l);const o=new Uint8Array(s),r=new Blob([o]),i=URL.createObjectURL(r),n=document.createElement("a");n.href=i,n.download=a,n.style.display="none",document.body.append(n),n.click(),n.remove(),setTimeout(()=>URL.revokeObjectURL(i),1e4)},onNodeClick:function(a){this.selectedNode=a,this.loadNodePage(a.destination_hash,"/page/index.mu")},getNomadnetPageDownloadCallbackKey:function(a,e){return`${a}:${e}`},getNomadnetFileDownloadCallbackKey:function(a,e){return`${a}:${e}`},async getNodePath(a){this.selectedNodePath=null;try{const e=await window.axios.get(`/api/v1/destination/${a}/path`);this.selectedNodePath=e.data.path}catch(e){console.log(e)}},downloadNomadNetFile(a,e,t,s,o){try{this.nomadnetFileDownloadCallbacks[this.getNomadnetFileDownloadCallbackKey(a,e)]={onSuccessCallback:t,onFailureCallback:s,onProgressCallback:o},N.send(JSON.stringify({type:"nomadnet.file.download",nomadnet_file_download:{destination_hash:a,file_path:e}}))}catch(r){console.error(r)}},downloadNomadNetPage(a,e,t,s,o,r){try{this.nomadnetPageDownloadCallbacks[this.getNomadnetPageDownloadCallbackKey(a,e)]={onSuccessCallback:s,onFailureCallback:o,onProgressCallback:r},N.send(JSON.stringify({type:"nomadnet.page.download",nomadnet_page_download:{destination_hash:a,page_path:e,field_data:t}}))}catch(i){console.error(i)}}}},ue={class:"flex flex-col flex-1 overflow-hidden min-w-full sm:min-w-[500px] dark:bg-zinc-950"},he={key:0,class:"flex flex-col h-full bg-white dark:bg-zinc-950 overflow-hidden sm:m-2 sm:border dark:border-zinc-800 sm:rounded-xl sm:shadow dark:shadow-zinc-900"},ge={class:"flex p-2 border-b border-gray-300 dark:border-zinc-800"},fe={class:"my-auto dark:text-gray-100"},pe={class:"font-semibold"},me={class:"my-auto ml-auto mr-2"},be=d("div",{class:"flex text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-zinc-800 hover:bg-gray-200 dark:hover:bg-zinc-700 p-1 rounded-full"},[d("div",null,[d("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",class:"w-5 h-5"},[d("path",{d:"M6.28 5.22a.75.75 0 0 0-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 1 0 1.06 1.06L10 11.06l3.72 3.72a.75.75 0 1 0 1.06-1.06L11.06 10l3.72-3.72a.75.75 0 0 0-1.06-1.06L10 8.94 6.28 5.22Z"})])])],-1),ke=[be],ye={class:"flex w-full border-gray-300 dark:border-zinc-800 border-b p-2"},_e=d("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",class:"w-5 h-5"},[d("path",{"fill-rule":"evenodd",d:"M9.293 2.293a1 1 0 0 1 1.414 0l7 7A1 1 0 0 1 17 11h-1v6a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1v-3a1 1 0 0 0-1-1H9a1 1 0 0 0-1 1v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-6H3a1 1 0 0 1-.707-1.707l7-7Z","clip-rule":"evenodd"})],-1),we=[_e],ve=d("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",class:"w-5 h-5"},[d("path",{"fill-rule":"evenodd",d:"M15.312 11.424a5.5 5.5 0 0 1-9.201 2.466l-.312-.311h2.433a.75.75 0 0 0 0-1.5H3.989a.75.75 0 0 0-.75.75v4.242a.75.75 0 0 0 1.5 0v-2.43l.31.31a7 7 0 0 0 11.712-3.138.75.75 0 0 0-1.449-.39Zm1.23-3.723a.75.75 0 0 0 .219-.53V2.929a.75.75 0 0 0-1.5 0V5.36l-.31-.31A7 7 0 0 0 3.239 8.188a.75.75 0 1 0 1.448.389A5.5 5.5 0 0 1 13.89 6.11l.311.31h-2.432a.75.75 0 0 0 0 1.5h4.243a.75.75 0 0 0 .53-.219Z","clip-rule":"evenodd"})],-1),xe=[ve],Ce=["disabled"],Pe=d("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",class:"w-5 h-5"},[d("path",{"fill-rule":"evenodd",d:"M17 10a.75.75 0 0 1-.75.75H5.612l4.158 3.96a.75.75 0 1 1-1.04 1.08l-5.5-5.25a.75.75 0 0 1 0-1.08l5.5-5.25a.75.75 0 1 1 1.04 1.08L5.612 9.25H16.25A.75.75 0 0 1 17 10Z","clip-rule":"evenodd"})],-1),Ne=[Pe],Se={class:"my-auto mx-2 w-full"},Ee=d("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",class:"w-5 h-5"},[d("path",{"fill-rule":"evenodd",d:"M3 10a.75.75 0 0 1 .75-.75h10.638L10.23 5.29a.75.75 0 1 1 1.04-1.08l5.5 5.25a.75.75 0 0 1 0 1.08l-5.5 5.25a.75.75 0 1 1-1.04-1.08l4.158-3.96H3.75A.75.75 0 0 1 3 10Z","clip-rule":"evenodd"})],-1),Te=[Ee],De={class:"h-full overflow-y-scroll p-3 bg-black text-white nodeContainer"},Le={key:0,class:"flex"},Fe=d("div",{class:"my-auto"},[d("svg",{class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[d("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),d("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})])],-1),Ae={class:"my-auto"},Ue=["innerHTML"],ze={key:0,class:"flex w-full border-gray-300 dark:border-zinc-800 border-t p-2 dark:text-gray-100"},Me=d("div",{class:"my-auto mr-2"},[d("svg",{class:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[d("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),d("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})])],-1),Be={class:"my-auto"},He={key:1,class:"flex flex-col mx-auto my-auto text-center leading-5 dark:text-gray-100"},Oe=d("div",{class:"mx-auto mb-1"},[d("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6 dark:text-gray-300"},[d("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 21a9.004 9.004 0 0 0 8.716-6.747M12 21a9.004 9.004 0 0 1-8.716-6.747M12 21c2.485 0 4.5-4.03 4.5-9S14.485 3 12 3m0 18c-2.485 0-4.5-4.03-4.5-9S9.515 3 12 3m0 0a8.997 8.997 0 0 1 7.843 4.582M12 3a8.997 8.997 0 0 0-7.843 4.582m15.686 0A11.953 11.953 0 0 1 12 10.5c-2.998 0-5.74-1.1-7.843-2.918m15.686 0A8.959 8.959 0 0 1 21 12c0 .778-.099 1.533-.284 2.253m0 0A17.919 17.919 0 0 1 12 16.5c-3.162 0-6.133-.815-8.716-2.247m0 0A9.015 9.015 0 0 1 3 12c0-1.605.42-3.113 1.157-4.418"})])],-1),je=d("div",{class:"font-semibold"},"No Active Node",-1),qe=d("div",null,"Select a Node to start browsing!",-1),Re={class:"mx-auto mt-2"};function $e(a,e,t,s,o,r){var n;const i=D("NomadNetworkSidebar");return h(),g(A,null,[z(i,{nodes:o.nodes,"selected-destination-hash":(n=o.selectedNode)==null?void 0:n.destination_hash,onNodeClick:r.onNodeClick},null,8,["nodes","selected-destination-hash","onNodeClick"]),d("div",ue,[o.selectedNode?(h(),g("div",he,[d("div",ge,[d("div",fe,[d("span",pe,y(o.selectedNode.display_name),1),o.selectedNodePath?(h(),g("span",{key:0,onClick:e[0]||(e[0]=l=>r.onDestinationPathClick(o.selectedNodePath)),class:"text-sm cursor-pointer"}," - "+y(o.selectedNodePath.hops)+" "+y(o.selectedNodePath.hops===1?"hop":"hops")+" away",1)):P("",!0)]),d("div",me,[d("div",{onClick:e[1]||(e[1]=l=>o.selectedNode=null),class:"cursor-pointer"},ke)])]),d("div",ye,[d("button",{onClick:e[2]||(e[2]=l=>r.loadNodePage(o.selectedNode.destination_hash,"/page/index.mu")),type:"button",class:"my-auto text-gray-500 dark:text-gray-300 bg-gray-200 dark:bg-zinc-800 hover:bg-gray-300 dark:hover:bg-zinc-700 rounded p-1 cursor-pointer"},we),d("button",{onClick:e[3]||(e[3]=(...l)=>r.reloadNodePage&&r.reloadNodePage(...l)),type:"button",class:"ml-1 my-auto text-gray-500 dark:text-gray-300 bg-gray-200 dark:bg-zinc-800 hover:bg-gray-300 dark:hover:bg-zinc-700 rounded p-1 cursor-pointer"},xe),d("button",{onClick:e[4]||(e[4]=(...l)=>r.loadPreviousNodePage&&r.loadPreviousNodePage(...l)),type:"button",disabled:o.nodePagePathHistory.length===0,class:U([[o.nodePagePathHistory.length>0?"text-gray-500 dark:text-gray-300 bg-gray-200 dark:bg-zinc-800 hover:bg-gray-300 dark:hover:bg-zinc-700":"text-gray-400 dark:text-gray-500 bg-gray-100 dark:bg-zinc-900"],"ml-1 my-auto rounded p-1 cursor-pointer"])},Ne,10,Ce),d("div",Se,[L(d("input",{"onUpdate:modelValue":e[5]||(e[5]=l=>o.nodePagePathUrlInput=l),onKeyup:e[6]||(e[6]=q(l=>r.onNodePageUrlClick(o.nodePagePathUrlInput),["enter"])),type:"text",placeholder:"Enter Destination URL",class:"bg-gray-50 dark:bg-zinc-900 border border-gray-300 dark:border-zinc-700 text-gray-900 dark:text-gray-100 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full px-2.5 py-1.5 dark:placeholder-gray-400"},null,544),[[F,o.nodePagePathUrlInput]])]),d("button",{onClick:e[7]||(e[7]=l=>r.onNodePageUrlClick(o.nodePagePathUrlInput)),type:"button",class:"my-auto text-gray-500 dark:text-gray-300 bg-gray-200 dark:bg-zinc-800 hover:bg-gray-300 dark:hover:bg-zinc-700 rounded p-1 cursor-pointer"},Te)]),d("div",De,[o.isLoadingNodePage?(h(),g("div",Le,[Fe,d("div",Ae,"Loading "+y(o.nodePageProgress)+"%",1)])):(h(),g("pre",{key:1,innerHTML:o.nodePageContent,class:"h-full text-wrap"},null,8,Ue))]),o.isDownloadingNodeFile?(h(),g("div",ze,[Me,d("div",Be,"Downloading: "+y(o.nodeFilePath)+" ("+y(o.nodeFileProgress)+"%)",1)])):P("",!0)])):(h(),g("div",He,[Oe,je,qe,d("div",Re,[d("button",{onClick:e[8]||(e[8]=R((...l)=>r.openUrl&&r.openUrl(...l),["stop"])),type:"button",class:"my-auto inline-flex items-center gap-x-1 rounded-md bg-gray-500 px-2 py-1 text-sm font-semibold text-white shadow-sm hover:bg-gray-400 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-gray-500 dark:bg-zinc-800 dark:text-white dark:hover:bg-zinc-700 dark:focus-visible:outline-zinc-500"}," Open a Nomadnet URL ")])]))])],64)}const Ke=T(ce,[["render",$e]]);export{Ke as default};
